---
description: "Execute query guardrails"
globs: ["server/controllers/queryController.js", "server.js"]
alwaysApply: true
---

# Execute Query Guardrails

## Must
- "Allow only: SELECT and EXPLAIN (no DDL/DML). Remove CREATE/ALTER from allowlist"
- "Reject multiple statements and comments that can hide injected commands"
- "Apply a server-side LIMIT (configurable) when missing"
- "Set MAX_EXECUTION_TIME per session; kill long-running queries gracefully and return 408-like error"
- "Whitelist accessible schemas/tables if feasible"

## Should
- "Optionally diff user results vs. expected using controlled queries from safe sources"

## Avoid
- "Executing user-provided DDL or DML in any environment"
